import{$ as p,Aa as de,B as I,Ba as ce,C as ee,Ca as me,D as Y,Fa as he,Ha as ue,Ia as w,J as s,Ja as _e,K as o,L as a,La as fe,M as J,Ma as ve,Na as L,Oa as K,Pa as x,Qa as ge,Ra as Ee,Ta as O,U as T,W as h,Wa as Ie,X as b,Xa as Ce,Y as _,Ya as ye,Z as f,_ as v,_a as Z,aa as m,ab as Se,ba as u,bb as be,cb as A,da as ie,db as B,ea as l,eb as P,fa as d,fb as U,ga as te,gb as V,hb as N,ib as R,jb as k,k as F,kb as D,l as M,la as re,lb as Q,ma as ne,mb as j,na as oe,nb as q,ob as H,pb as Fe,v as E,w as $,wa as ae,x as t,xa as se,ya as pe,za as le}from"./chunk-IMJXV2OR.js";function Ve(g,C){if(g&1){let y=T();o(0,"div")(1,"section",2)(2,"header",3)(3,"h2",4),p(4),l(5,"translate"),a()(),o(6,"div",8)(7,"app-health-canada-only",29),h("errorList",function(n){F(y);let e=b();return M(e.processHealthCanadaOnlyErrors(n))}),a()()()()}if(g&2){let y=b();t(4),m(d(5,3,"panel.title.hc.only")),t(3),s("showErrors",y.showErrors)("hcuseOnlyModel",y.hcuseOnlyModel)}}function Ne(g,C){if(g&1){let y=T();o(0,"button",26),h("click",function(){F(y);let n=b();return M(n.saveXmlFile())}),p(1),l(2,"translate"),a()}g&2&&(t(),u(" ",d(2,1,"generate.final.internal")," "))}function Re(g,C){if(g&1){let y=T();o(0,"button",26),h("click",function(){F(y);let n=b();return M(n.saveXmlFile())}),p(1),l(2,"translate"),a()}g&2&&(t(),u(" ",d(2,1,"generate.final.external")," "))}var Fi=(()=>{let C=class C{constructor(i,n,e,r,c,z,G,W,X){this._fb=i,this.cdr=n,this._baseService=e,this._globalService=r,this._utilsService=c,this.fileServices=z,this._versionService=G,this._checkSumService=W,this.datepipe=X,this._patentInformationErrors=[],this._drugUseErrors=[],this._noticeOfComplianceErrors=[],this._newDrugSubmissionInfoErrors=[],this._medicinalIngredientsForErrors=[],this._timingOfApplicantForErrors=[],this._attestationsForErrors=[],this._feesForErrors=[],this._certificationForErrors=[],this._applicantErrors=[],this._healthCanadaOnlyErrors=[],this.errorList=[],this.headingLevel="h2",this.rootTagText=Ce,this.versionTagPath=ye,this.startCheckSumVersionNum=2,this.countryOptions=[],this.showErrors=!1}ngOnInit(){this.rtForm||(this.rtForm=this._baseService.getReactiveModel(this._fb));try{this._globalService.enrollment?this.enrollModel=this._globalService.enrollment:(this.enrollModel=this._baseService.getEmptyEnrol(),this._globalService.enrollment=this.enrollModel),this.transactionEnrollModel=this.enrollModel[this.rootTagText],this._initModels(this.transactionEnrollModel),this.lang=this._globalService.currLanguage,this.countryOptions=this._globalService.countryList,this.helpIndex=this._globalService.helpIndex,this.devEnv=this._globalService.devEnv,this.byPassCheckSum=this._globalService.byPassChecksum,this.isInternal=Ie.isInternal}catch(i){console.error(i)}}ngAfterViewInit(){document.location.href="#def-top",this.msgList.changes.subscribe(i=>{let n=[];this._updateErrorList(i),this.processErrors()}),this.msgList.notifyOnChanges()}_updateErrorList(i){}processErrors(){this.errorList=[],this.errorList=this.errorList.concat(this._applicantErrors),this.errorList=this.errorList.concat(this._patentInformationErrors),this.errorList=this.errorList.concat(this._newDrugSubmissionInfoErrors),this.errorList=this.errorList.concat(this._noticeOfComplianceErrors),this.errorList=this.errorList.concat(this._drugUseErrors),this.errorList=this.errorList.concat(this._timingOfApplicantForErrors),this.errorList=this.errorList.concat(this._medicinalIngredientsForErrors),this.errorList=this.errorList.concat(this._attestationsForErrors),this.errorList=this.errorList.concat(this._feesForErrors),this.errorList=this.errorList.concat(this._certificationForErrors),this.cdr.detectChanges()}processHealthCanadaOnlyErrors(i){this._healthCanadaOnlyErrors=i,this.processErrors()}processPatentInfoErrors(i){this._patentInformationErrors=i,this.processErrors()}processDrugUseErrors(i){this._drugUseErrors=i,this.processErrors()}processNoticeOfComplianceErrors(i){this._noticeOfComplianceErrors=i,this.processErrors()}processNewDrugSubmissionInfoErrors(i){this._newDrugSubmissionInfoErrors=i,this.processErrors()}processMedicinalIngredientsErrors(i){this._medicinalIngredientsForErrors=i,this.processErrors()}processAttestationsErrors(i){this._attestationsForErrors=i,this.processErrors()}processFeesErrors(i){this._feesForErrors=i,this.processErrors()}processTimingOfApplicantErrors(i){this._timingOfApplicantForErrors=i,this.processErrors()}processCertificationErrors(i){this._certificationForErrors=i,this.processErrors()}processApplicantErrors(i){this._applicantErrors=i,this.processErrors()}hideErrorSummary(){return this.showErrors&&this.errorList&&this.errorList.length>0}saveXmlFile(){this.showErrors=!0,this.processErrors(),this._saveXML()}saveWorkingCopyFile(){let i=this._prepareForSaving(!1),n=this._generateFileName(i.CERTIFICATE_SUPPLEMENTARY_PROTECTION.enrolment_version);this.fileServices.saveJsonToFile(i,n,null),this.saveWorkCopyTime=Date.now()}processFile(i){i.data!==null&&(this.transactionEnrollModel=i.data.CERTIFICATE_SUPPLEMENTARY_PROTECTION,this._initModels(this.transactionEnrollModel))}_initModels(i){this.cspiModel=this._baseService.getCerSuppProtect(),this.cspiModel.dateLastSaved=i.date_saved,this.cspiModel.enrollVersion=i.enrolment_version,i.application_info!=null&&(this.attestationModel=this._baseService.getAttestation(),this.drugUseModel=i.application_info.drug_use,this.patentModel=i.application_info.patent_info,this.timingOfApplicantModel=i.application_info.time_application,this.nocModel=i.application_info.noc_date,this.newDrugSubmissionModel=i.application_info.control_number,this.attestationModel.attestationAsApplicant=i.application_info.applicant_statement,this.attestationModel.attestationAsSubmission.timely_submission_statement=i.timely_submission_info.timely_submission_statement,this.attestationModel.attestationAsSubmission.marketing_application_date=i.timely_submission_info.marketing_application_date,this.attestationModel.attestationAsSubmission.marketing_country=i.timely_submission_info.marketing_country),this.hcuseOnlyModel=i.health_canada_only,this.feePaymentModel=i.advanced_payment,this.certModel=i.certification,i.advanced_payment!=null&&(this.transFeeModel=i.advanced_payment),this.applicantModel=this._baseService.getEmptyApplicant();let n=i.applicant;if(console.log(Array.isArray(i.applicant)),!Array.isArray(i.applicant)){let e=[],r=Object.entries(i.applicant);e.push(i.applicant),i.applicant=e}if(i.applicant&&i.applicant.length>0){let e=i.applicant[0];if(this.applicantModel=e,this.convertAddress(this.applicantModel.address),i.applicant[0].contact&&(this.contactModel=i.applicant[0].contact,this.convertLanguage(this.contactModel)),i.applicant[0].address&&(this.addressModel=i.applicant[0].address),i.applicant.length>1){let r=i.applicant[1];this.billingModel=r,this.convertAddress(this.billingModel.address),r.contact&&(this.contactBillingModel=r.contact,this.convertLanguage(this.contactBillingModel)),r.address&&(this.addressBillingModel=r.address)}}}preload(){}unloadNotification(i){i.returnValue=!0}_saveXML(){if(this.errorList&&this.errorList.length<1){let i=this._prepareForSaving(!0),n=this._generateFileName(i.CERTIFICATE_SUPPLEMENTARY_PROTECTION.enrolment_version),e=this._versionService.getApplicationMajorVersionWithUnderscore(this._globalService.appVersion),r=Z.toUpperCase()+"_RT_"+e+".xsl";this.fileServices.saveXmlToFile(i,n,!0,r);return}document.location.href="#topErrorSummaryId"}_prepareForSaving(i){let n=this._baseService.getEmptyTransactionEnrol(),e=this.patentComponent.getFormValue();this._baseService.mapPatentFormsToOutput(n,e);let r=this.drugUseComponent.getFormValue();this._baseService.mapDrugUseFormsToOutput(n,r);let c=this.noticeOfComplianceComponent.getFormValue();this._baseService.mapNOCFormsToOutput(n,c);let z=this.newDrugSubmissionInformationComponent.getFormValue();this._baseService.mapNewDrugSubmissionInformationFormsToOutput(n,z);let G=this.feesComponent.getFormValue();this._baseService.mapFeesFormsToOutput(n,G);let W=this.medicinalIngredientsComponent.getFormValue();this._baseService.mapMedicinalIngredientsFormsToOutput(n,W);let X=this.timeOfApplicationComponent.getFormValue();if(this._baseService.mapTimingOfApplicantFormsToOutput(n,X),this.isInternal){let Pe=this.healthCanadaComponent.getFormValue();this._baseService.mapHealthCanadaOnlyFormsToOutput(n,Pe)}let Te=this.certificationComponent.getFormValue();this._baseService.mapCertificationFormsToOutput(n,Te);let we=this.applicantComponent.getFormValue(),Le=this.applicantComponent.getApplicantAddressFormValue(),xe=this.applicantComponent.getApplicantContactFormValue(),Oe=this.applicantComponent.getBillingAddressFormValue(),Ae=this.applicantComponent.getBillingContactFormValue();this._baseService.mapApplicantInfoToOutput(n,we,Le,xe,Oe,Ae);let Be=this.attestationComponent.getFormValue();this._baseService.mapAttestationFormsToOutput(n,Be,this.lang,this.countryOptions),this._baseService.mapCertificateOfSupplementaryProtectionFormsToOutput(n,this.cspiModel,this._baseService.certSuppProtectForm),n.software_version=this._globalService.appVersion,n.form_language=this._globalService.currLanguage;let S={CERTIFICATE_SUPPLEMENTARY_PROTECTION:n};return i&&(S.CERTIFICATE_SUPPLEMENTARY_PROTECTION[K]="",S.CERTIFICATE_SUPPLEMENTARY_PROTECTION[K]=this._checkSumService.createHash(S)),console.log("_prepareForSaving ~ output",JSON.stringify(S,null,2)),S}_generateFileName(i){return(Z+"-"+i).replace(".","-")}onChanged(i,n){i?.target?.checked===!1&&this.rtForm.controls[n].reset()}convertAddress(i){if(i.country._id==null&&i.country.__text){let n=this._globalService.countryIdMappingList.find(e=>e.id===i.country.__text);if(n!=null&&(i.country._id=n.newid),i.country._id==="CA"||i.country._id==="US"){let e=String(i.province_lov),r=this._baseService.getEmptyIIdTextLabel();r._id=e,i.province_lov=r}else i.province_text=i.province_text}}convertLanguage(i){if(i.language_correspondance._id==null&&i.language_correspondance){let n=this._baseService.getEmptyIIdTextLabel();n._id=String(i.language_correspondance),i.language_correspondance=n}}};C.\u0275fac=function(n){return new(n||C)(I(ce),I(te),I(A),I(be),I(w),I(L),I(O),I(x),I(ne))},C.\u0275cmp=ee({type:C,selectors:[["app-form-base"]],viewQuery:function(n,e){if(n&1&&(_(P,5),_(U,5),_(V,5),_(N,5),_(R,5),_(j,5),_(k,5),_(Q,5),_(q,5),_(D,5),_(H,5),_(B,5),_(he,5)),n&2){let r;f(r=v())&&(e.patentComponent=r.first),f(r=v())&&(e.drugUseComponent=r.first),f(r=v())&&(e.noticeOfComplianceComponent=r.first),f(r=v())&&(e.newDrugSubmissionInformationComponent=r.first),f(r=v())&&(e.medicinalIngredientsComponent=r.first),f(r=v())&&(e.timeOfApplicationComponent=r.first),f(r=v())&&(e.feesComponent=r.first),f(r=v())&&(e.applicantComponent=r.first),f(r=v())&&(e.healthCanadaComponent=r.first),f(r=v())&&(e.certificationComponent=r.first),f(r=v())&&(e.attestationComponent=r.first),f(r=v())&&(e.certSuppProtectComponent=r.first),f(r=v())&&(e.msgList=r)}},hostBindings:function(n,e){n&1&&h("beforeunload",function(c){return e.unloadNotification(c)},$)},features:[ie([L,w,O,x,ve,fe,A,Se])],decls:159,vars:148,consts:[[1,"container-fluid","wb-frmvld","wb-init","wb-frmvld-inited"],["name","transactionForm","novalidate","",3,"formGroup"],[1,"panel","panel-primary","mrgn-tp-lg"],[1,"panel-heading","clearfix"],[1,"panel-title"],[3,"id"],[1,"fn-lnk","mrgn-tp-md",3,"href"],[1,"wb-inv"],[1,"panel-body"],[3,"complete","rootTag","lang","versionTagPath","startCheckSumVersion","byPassCheckSum","devEnv"],["id","topErrorSummaryId"],["headingPreamble","errorSummary.cspfile",3,"hiddenSummary","errorList","headingLevel"],[4,"ngIf"],[3,"saveWorkCopyTime","cspiModel"],[3,"errorList","showErrors","applicantAddressModel","applicantContactModel","billingAddressModel","billingContactModel","applicantModel","billingModel"],[3,"errorList","showErrors","patentModel"],[3,"errorList","showErrors","newDrugSubmissionModel"],[3,"errorList","showErrors","nocModel"],[3,"errorList","showErrors","drugUseModel"],[3,"errorList","showErrors","timingOfApplicantModel"],[3,"errorList","showErrors","transactionEnrollModel"],[3,"errorList","showErrors","attestationModel"],[3,"errorList","showErrors","feePaymentModel"],[3,"errorList","showErrors","certModel"],[1,"row","btn-group-sm"],[1,"form-group","col-md-4"],["type","button",1,"btn","btn-primary","btn-lg","active",3,"click"],["type","button","class","btn btn-primary btn-lg active",3,"click",4,"ngIf"],[1,"mrgn-tp-lg"],[3,"errorList","showErrors","hcuseOnlyModel"]],template:function(n,e){n&1&&(o(0,"div",0)(1,"form",1)(2,"div")(3,"section",2)(4,"header",3)(5,"h2",4),p(6),l(7,"translate"),o(8,"sup",5)(9,"a",6)(10,"span",7),p(11),l(12,"translate"),a(),p(13),a()()()(),o(14,"div",8)(15,"lib-file-reader",9),h("complete",function(c){return e.processFile(c)}),a()()()(),o(16,"div",10),J(17,"lib-error-summary",11),a(),Y(18,Ve,8,5,"div",12),o(19,"div")(20,"section",2)(21,"header",3)(22,"h2",4),p(23),l(24,"translate"),o(25,"sup",5)(26,"a",6)(27,"span",7),p(28),l(29,"translate"),a(),p(30),a()()()(),o(31,"div",8),J(32,"app-cert-supp-protect",13),a(),o(33,"header",8)(34,"h3",4),p(35),l(36,"translate"),o(37,"sup",5)(38,"a",6)(39,"span",7),p(40),l(41,"translate"),a(),p(42),a()()()(),o(43,"div",8)(44,"app-applicant",14),h("errorList",function(c){return e.processApplicantErrors(c)}),a()(),o(45,"header",8)(46,"h3",4),p(47),l(48,"translate"),o(49,"sup",5)(50,"a",6)(51,"span",7),p(52),l(53,"translate"),a(),p(54),a()()()(),o(55,"div",8)(56,"app-patent",15),h("errorList",function(c){return e.processPatentInfoErrors(c)}),a()(),o(57,"header",8)(58,"h3",4),p(59),l(60,"translate"),o(61,"sup",5)(62,"a",6)(63,"span",7),p(64),l(65,"translate"),a(),p(66),a()()()(),o(67,"div",8)(68,"app-new-drug-submission-information",16),h("errorList",function(c){return e.processNewDrugSubmissionInfoErrors(c)}),a()(),o(69,"header",8)(70,"h3",4),p(71),l(72,"translate"),o(73,"sup",5)(74,"a",6)(75,"span",7),p(76),l(77,"translate"),a(),p(78),a()()()(),o(79,"div",8)(80,"app-notice-of-compliance",17),h("errorList",function(c){return e.processNoticeOfComplianceErrors(c)}),a()(),o(81,"header",8)(82,"h3",4),p(83),l(84,"translate"),o(85,"sup",5)(86,"a",6)(87,"span",7),p(88),l(89,"translate"),a(),p(90),a()()()(),o(91,"div",8)(92,"app-drug-use",18),h("errorList",function(c){return e.processDrugUseErrors(c)}),a()(),o(93,"header",8)(94,"h3",4),p(95),l(96,"translate"),a()(),o(97,"div",8)(98,"app-time-of-application",19),h("errorList",function(c){return e.processTimingOfApplicantErrors(c)}),a()(),o(99,"header",8)(100,"h3",4),p(101),l(102,"translate"),o(103,"sup",5)(104,"a",6)(105,"span",7),p(106),l(107,"translate"),a(),p(108),a()()()(),o(109,"div",8)(110,"app-medicinal-ingredients",20),h("errorList",function(c){return e.processMedicinalIngredientsErrors(c)}),a()(),o(111,"header",8)(112,"h3",4),p(113),l(114,"translate"),o(115,"sup",5)(116,"a",6)(117,"span",7),p(118),l(119,"translate"),a(),p(120),a()()()(),o(121,"div",8)(122,"app-attestation",21),h("errorList",function(c){return e.processAttestationsErrors(c)}),a()(),o(123,"header",8)(124,"h3",4),p(125),l(126,"translate"),o(127,"sup",5)(128,"a",6)(129,"span",7),p(130),l(131,"translate"),a(),p(132),a()()()(),o(133,"div",8)(134,"app-fees",22),h("errorList",function(c){return e.processFeesErrors(c)}),a()(),o(135,"header",8)(136,"h3",4),p(137),l(138,"translate"),o(139,"sup",5)(140,"a",6)(141,"span",7),p(142),l(143,"translate"),a(),p(144),a()()()(),o(145,"div",8)(146,"app-certification",23),h("errorList",function(c){return e.processCertificationErrors(c)}),a()()()(),o(147,"div",24)(148,"div",25)(149,"button",26),h("click",function(){return e.saveWorkingCopyFile()}),p(150),l(151,"translate"),a()(),o(152,"div",25),Y(153,Ne,3,3,"button",27)(154,Re,3,3,"button",27),a()(),o(155,"div",28)(156,"span"),p(157),l(158,"translate"),a()()()()),n&2&&(t(),s("formGroup",e.rtForm),t(5),u("",d(7,98,"load.file")," "),t(2),s("id",e.helpIndex.loadFileIndx[2]),t(),s("href","#"+e.helpIndex.loadFileIndx[1],E),t(2),m(d(12,100,"instruction")),t(2),m(e.helpIndex.loadFileIndx[0]),t(2),s("rootTag",e.rootTagText)("lang",e.lang)("versionTagPath",e.versionTagPath)("startCheckSumVersion",e.startCheckSumVersionNum)("byPassCheckSum",e.byPassCheckSum)("devEnv",e.devEnv),t(2),s("hiddenSummary",e.hideErrorSummary())("errorList",e.errorList)("headingLevel",e.headingLevel),t(),s("ngIf",e.isInternal),t(5),u("",d(24,102,"panel.title.csp")," "),t(2),s("id",e.helpIndex.dateLastIndx[2]),t(),s("href","#"+e.helpIndex.dateLastIndx[1],E),t(2),m(d(29,104,"instruction")),t(2),m(e.helpIndex.dateLastIndx[0]),t(2),s("saveWorkCopyTime",e.saveWorkCopyTime)("cspiModel",e.cspiModel),t(3),u("",d(36,106,"panel.title.applicant")," "),t(2),s("id",e.helpIndex.appContactIndx[2]),t(),s("href","#"+e.helpIndex.appContactIndx[1],E),t(2),m(d(41,108,"instruction")),t(2),m(e.helpIndex.appContactIndx[0]),t(2),s("showErrors",e.showErrors)("applicantAddressModel",e.addressModel)("applicantContactModel",e.contactModel)("billingAddressModel",e.addressBillingModel)("billingContactModel",e.contactBillingModel)("applicantModel",e.applicantModel)("billingModel",e.billingModel),t(3),u("",d(48,110,"panel.title.patent")," "),t(2),s("id",e.helpIndex.patentInfoIndx[2]),t(),s("href","#"+e.helpIndex.patentInfoIndx[1],E),t(2),m(d(53,112,"instruction")),t(2),m(e.helpIndex.patentInfoIndx[0]),t(2),s("showErrors",e.showErrors)("patentModel",e.patentModel),t(3),u("",d(60,114,"panel.title.new.drug.submission.info")," "),t(2),s("id",e.helpIndex.newDrugIndx[2]),t(),s("href","#"+e.helpIndex.newDrugIndx[1],E),t(2),m(d(65,116,"instruction")),t(2),m(e.helpIndex.newDrugIndx[0]),t(2),s("showErrors",e.showErrors)("newDrugSubmissionModel",e.newDrugSubmissionModel),t(3),u("",d(72,118,"panel.title.noticeofcompliance")," "),t(2),s("id",e.helpIndex.nocDateIndx[2]),t(),s("href","#"+e.helpIndex.nocDateIndx[1],E),t(2),m(d(77,120,"instruction")),t(2),m(e.helpIndex.nocDateIndx[0]),t(2),s("showErrors",e.showErrors)("nocModel",e.nocModel),t(3),u("",d(84,122,"panel.title.druguse")," "),t(2),s("id",e.helpIndex.drugUseIndx[2]),t(),s("href","#"+e.helpIndex.drugUseIndx[1],E),t(2),m(d(89,124,"instruction")),t(2),m(e.helpIndex.drugUseIndx[0]),t(2),s("showErrors",e.showErrors)("drugUseModel",e.drugUseModel),t(3),m(d(96,126,"panel.title.timing.of.application")),t(3),s("showErrors",e.showErrors)("timingOfApplicantModel",e.timingOfApplicantModel),t(3),u("",d(102,128,"panel.title.medicinal.ingredients")," "),t(2),s("id",e.helpIndex.medicIngrIndx[2]),t(),s("href","#"+e.helpIndex.medicIngrIndx[1],E),t(2),m(d(107,130,"instruction")),t(2),m(e.helpIndex.medicIngrIndx[0]),t(2),s("showErrors",e.showErrors)("transactionEnrollModel",e.transactionEnrollModel),t(3),u("",d(114,132,"panel.title.attestations")," "),t(2),s("id",e.helpIndex.attestationIndx[2]),t(),s("href","#"+e.helpIndex.attestationIndx[1],E),t(2),m(d(119,134,"instruction")),t(2),m(e.helpIndex.attestationIndx[0]),t(2),s("showErrors",e.showErrors)("attestationModel",e.attestationModel),t(3),u("",d(126,136,"panel.title.fees")," "),t(2),s("id",e.helpIndex.feePayIndx[2]),t(),s("href","#"+e.helpIndex.feePayIndx[1],E),t(2),m(d(131,138,"instruction")),t(2),m(e.helpIndex.feePayIndx[0]),t(2),s("showErrors",e.showErrors)("feePaymentModel",e.feePaymentModel),t(3),u("",d(138,140,"panel.title.certification")," "),t(2),s("id",e.helpIndex.certificationIndx[2]),t(),s("href","#"+e.helpIndex.certificationIndx[1],E),t(2),m(d(143,142,"instruction")),t(2),m(e.helpIndex.certificationIndx[0]),t(2),s("showErrors",e.showErrors)("certModel",e.certModel),t(4),u(" ",d(151,144,"save.working.copy")," "),t(3),s("ngIf",e.isInternal),t(),s("ngIf",!e.isInternal),t(3),m(d(158,146,"public.disc")))},dependencies:[oe,re,se,me,le,pe,de,Ee,ge,_e,ue,Fe,q,B,P,U,V,N,R,j,Q,D,k,H,ae],encapsulation:2});let g=C;return g})();export{Fi as FormBaseComponent};
